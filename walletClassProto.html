<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Wallet Class Proto - HW1</title>
</head>
<body>
    
<script>

var productsArr = [];

class Wallet {
  static createOpenSource(walletData) {
    let wallet = new Wallet;
    wallet.name = walletData.name;
    wallet.currency = walletData.currency;
    wallet.platform = walletData.platform;
    wallet.os = walletData.os;
    wallet.description = walletData.description;
    wallet.sourceCode = walletData.sourceCode;

    wallet.showSourceCode = function() {
        return this.sourceCode;
    }
    return wallet;
  }
  static createClosedSource(walletData) {
    let wallet = new Wallet;
    wallet.name = walletData.name;
    wallet.currency = walletData.currency;
    wallet.platform = walletData.platform;
    wallet.os = walletData.os;
    wallet.description = walletData.description;
    wallet.price = walletData.price;

    wallet.showPrice = function() {
        return this.price;
    }
    return wallet;
  }
  push(arr) {
    arr.push(this);
  }
}

var electrum = Wallet.createOpenSource({
    name: "Electrum",
    currency: "BTC",
    platform: "Desktop, Mobile",
    os: "Windows, MacOs, Linux, Android",
    description: "Electrum's focus is speed and simplicity, with low resource usage. It uses remote servers that handle the most complicated parts of the Bitcoin system, and it allows you to recover your wallet from a secret phrase.",
    sourceCode: "https://github.com/spesmilo/electrum"
}).push(productsArr);

var bitcoinCore = Wallet.createOpenSource({
    name: "Bitcoin Core",
    currency: "BTC",
    platform: "Desktop",
    os: "Windows, MacOs, Linux",
    description: "Bitcoin Core is a full Bitcoin client and builds the backbone of the network. It offers high levels of security, privacy, and stability. However, it has fewer features and it takes a lot of space and memory.",
    sourceCode: "https://github.com/bitcoin/bitcoin"
}).push(productsArr);

var trezor = Wallet.createOpenSource({
    name: "Trezor",
    currency: "BTC",
    platform: "Hardware",
    description: "Trezor is a hardware wallet providing a high level of security without sacrificing convenience. Unlike cold storage, Trezor is able to sign transactions while connected to an online device. That means spending bitcoins is secure even when using a compromised computer.",
    sourceCode: "https://github.com/trezor/"
}).push(productsArr);

var coinbase = Wallet.createClosedSource({
    name: "Coinbase",
    currency: "BTC, ETC, ETH, XRP",
    platform: "Web, Android",
    description: "Coinbase is a web wallet service that aims to be easy to use. It also provides an Android web wallet app, merchant tools and integration with US bank accounts to buy and sell bitcoins.",
    price: 10
}).push(productsArr);



// Search function
function search(searchTerm, productsArr) {
  // создаем временный массив для результатов посика внутри функции
  let tempArr = [];
  // перебираем массив объектов
  productsArr.forEach((item, i, productsArr) => {
  // в каждом объекте смотрим ключи
    for (key in item) {
  // регулярка для разделения строк в значениях ключа по , и проблелу
       let re = /\s|,\s/gi;
      // проверка для отсечения методов - ругается split
       if (typeof item[key] == "string") {
         // сплитом делим строку на массив слов, который перебираем форычом
       let m = item[key].split(re).forEach((item2) => {
         // если слово в массиве совпадает с искомым словом - пихаем во временный массив
          if (item2 == searchTerm)  {
          tempArr.push(item); 
          } 
       });
         
       }

    }
  })
  return tempArr;
  
}

console.log("BTC: " + search("BTC", productsArr));
console.log("Web: " + search("Web", productsArr));
console.log("Android: " + search("Android", productsArr));

</script>

</body>
</html>